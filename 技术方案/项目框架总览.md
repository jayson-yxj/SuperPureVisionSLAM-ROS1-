# é¡¹ç›®æ¡†æ¶æ€»è§ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: ORB-SLAM3 æ·±åº¦æ˜ å°„ ROS é›†æˆç³»ç»Ÿ

**æ ¸å¿ƒç›®æ ‡**: åŸºäºå•ç›®ç›¸æœºçš„å®æ—¶ SLAM + æ·±åº¦ä¼°è®¡ + 3D/2D åœ°å›¾æ„å»º

**ç¡¬ä»¶å¹³å°**: Jetson Orin (æˆ– x86 PC)

**è½¯ä»¶å¹³å°**: ROS Noetic (Ubuntu 20.04)

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å•ç›®ç›¸æœºè¾“å…¥                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   pub_video_node (è§†é¢‘å‘å¸ƒ)   â”‚
         â”‚   /camera/image_raw           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ORB-SLAM3      â”‚    â”‚  depth_maping_node   â”‚
â”‚  (ä½å§¿ä¼°è®¡)     â”‚â”€â”€â”€â–¶â”‚  (æ·±åº¦ä¼°è®¡)          â”‚
â”‚                 â”‚    â”‚  + GeoCalib é‡åŠ›å¯¹é½ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
         â”‚  /orb_slam3/          â”‚  /depth_anything/
         â”‚  image_pose           â”‚  depth_image
         â”‚                        â”‚
         â”‚                        â”‚  /o3d_pointCloud
         â”‚                        â”‚  (3D ç‚¹äº‘)
         â”‚                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ octomap_mapping_node   â”‚
      â”‚ (3D/2D åœ°å›¾æ„å»º)       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                â”‚
       â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /octomap_2d â”‚  â”‚ /octomap_        â”‚
â”‚ (2D å æ®å›¾) â”‚  â”‚ pointcloud       â”‚
â”‚             â”‚  â”‚ (3D ç‚¹äº‘å¯è§†åŒ–)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    RViz     â”‚
         â”‚  (å¯è§†åŒ–)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1ï¸âƒ£ ORB-SLAM3 æ¨¡å—

**ä½ç½®**: `src/` + `ros_orbslam_ws/src/ORB_SLAM3_ROS/`

**åŠŸèƒ½**:
- âœ… å•ç›®è§†è§‰ SLAM
- âœ… ç‰¹å¾æå–å’Œè·Ÿè¸ªï¼ˆORB ç‰¹å¾ï¼‰
- âœ… 6-DOF ä½å§¿ä¼°è®¡
- âœ… å›ç¯æ£€æµ‹å’Œåœ°å›¾ä¼˜åŒ–
- âœ… æ”¯æŒé±¼çœ¼ç›¸æœº

**è¾“å…¥**:
- `/camera/image_raw` (sensor_msgs/Image)

**è¾“å‡º**:
- `/orb_slam3/image_pose` (depth_maping/ImagePose)
  - åŒ…å«: å›¾åƒ + ä½å§¿ï¼ˆä½ç½® + å››å…ƒæ•°ï¼‰

**å…³é”®æ–‡ä»¶**:
- [`src/System.cc`](../src/System.cc) - SLAM ç³»ç»Ÿä¸»ç±»
- [`ros_orbslam_ws/src/ORB_SLAM3_ROS/src/ros_mono.cc`](../ros_orbslam_ws/src/ORB_SLAM3_ROS/src/ros_mono.cc) - ROS åŒ…è£…å™¨
- [`MonoConfig/Fisheye.yaml`](../MonoConfig/Fisheye.yaml) - ç›¸æœºé…ç½®

**æ€§èƒ½**: 40-60 FPS (Jetson Orin)

---

### 2ï¸âƒ£ Depth Anything V2 æ·±åº¦ä¼°è®¡æ¨¡å—

**ä½ç½®**: `ros_orbslam_ws/src/depth_maping/`

**åŠŸèƒ½**:
- âœ… å•ç›®æ·±åº¦ä¼°è®¡ï¼ˆæ·±åº¦å­¦ä¹ ï¼‰
- âœ… å®æ—¶ç‚¹äº‘ç”Ÿæˆå’Œå¯è§†åŒ–
- âœ… æ»‘åŠ¨çª—å£ç‚¹äº‘ç®¡ç†
- âœ… **é‡åŠ›å¯¹é½**ï¼ˆGeoCalib é›†æˆï¼‰
- âœ… åæ ‡ç³»è½¬æ¢ï¼ˆç›¸æœº â†’ ROSï¼‰

**è¾“å…¥**:
- `/orb_slam3/image_pose` (depth_maping/ImagePose)

**è¾“å‡º**:
- `/depth_anything/depth_image` (sensor_msgs/Image) - æ·±åº¦å›¾
- `/o3d_pointCloud` (sensor_msgs/PointCloud2) - 3D ç‚¹äº‘ï¼ˆå·²å¯¹é½ï¼‰

**å…³é”®æ–‡ä»¶**:
- [`scripts/depth_maping_node.py`](../ros_orbslam_ws/src/depth_maping/scripts/depth_maping_node.py) - ä¸»èŠ‚ç‚¹
- [`scripts/depth_anything_v2/`](../ros_orbslam_ws/src/depth_maping/scripts/depth_anything_v2/) - æ·±åº¦ä¼°è®¡æ¨¡å‹
- [`scripts/gravity_estimate.py`](../ros_orbslam_ws/src/depth_maping/scripts/gravity_estimate.py) - é‡åŠ›æ–¹å‘ä¼°è®¡
- [`scripts/setup_gravity_alignment.sh`](../ros_orbslam_ws/src/depth_maping/scripts/setup_gravity_alignment.sh) - è‡ªåŠ¨åŒ–è®¾ç½®

**æ–°å¢åŠŸèƒ½** (GeoCalib é›†æˆ):
- ğŸ†• åˆå§‹åŒ–æ—¶è‡ªåŠ¨ä¿å­˜å›¾åƒ
- ğŸ†• ä½¿ç”¨ GeoCalib ä¼°è®¡é‡åŠ›æ–¹å‘
- ğŸ†• è‡ªåŠ¨å¯¹é½ç‚¹äº‘åˆ°é‡åŠ›æ–¹å‘
- ğŸ†• æ–‡ä»¶ç³»ç»Ÿè§£è€¦ Python ç‰ˆæœ¬é—®é¢˜

**è¯¦ç»†æ–‡æ¡£**:
- [`QUICK_START_GRAVITY.md`](../ros_orbslam_ws/src/depth_maping/QUICK_START_GRAVITY.md)
- [`README_GRAVITY_ALIGNMENT.md`](../ros_orbslam_ws/src/depth_maping/README_GRAVITY_ALIGNMENT.md)

**æ€§èƒ½**: 15-30 FPS (Jetson Orin, vitb æ¨¡å‹)

---

### 3ï¸âƒ£ Octomap å»ºå›¾æ¨¡å—

**ä½ç½®**: `ros_orbslam_ws/src/octomap_mapping/`

**åŠŸèƒ½**:
- âœ… 3D å æ®åœ°å›¾æ„å»º
- âœ… 2D å æ®åœ°å›¾æŠ•å½±
- âœ… å°„çº¿è¿½è¸ªï¼ˆè‡ªç”±ç©ºé—´æ ‡è®°ï¼‰
- âœ… ä½“ç´ ç½‘æ ¼ç®¡ç†
- âœ… åæ ‡ç³»è½¬æ¢

**è¾“å…¥**:
- `/orb_slam3/image_pose` (depth_maping/ImagePose)
- `/depth_anything/depth_image` (sensor_msgs/Image)

**è¾“å‡º**:
- `/octomap_2d` (nav_msgs/OccupancyGrid) - 2D å æ®åœ°å›¾
- `/octomap_pointcloud` (sensor_msgs/PointCloud2) - 3D ç‚¹äº‘

**å…³é”®æ–‡ä»¶**:
- [`scripts/octomap_mapping_node.py`](../ros_orbslam_ws/src/octomap_mapping/scripts/octomap_mapping_node.py) - ä¸»èŠ‚ç‚¹
- [`launch/octomap_mapping.launch`](../ros_orbslam_ws/src/octomap_mapping/launch/octomap_mapping.launch) - å¯åŠ¨æ–‡ä»¶

**ç‰¹ç‚¹**:
- ç®€åŒ–çš„ä½“ç´ ç½‘æ ¼å®ç°ï¼ˆä¸å¼ºåˆ¶ä¾èµ– octomap åº“ï¼‰
- æ”¯æŒå®Œæ•´çš„åæ ‡ç³»è½¬æ¢
- å¯é…ç½®çš„åœ°å›¾å‚æ•°

**æ€§èƒ½**: 10 FPS æ›´æ–°ï¼Œ1 Hz å‘å¸ƒ

---

### 4ï¸âƒ£ è§†é¢‘å‘å¸ƒæ¨¡å—

**ä½ç½®**: `ros_orbslam_ws/src/pub_video/`

**åŠŸèƒ½**:
- âœ… ä»è§†é¢‘æ–‡ä»¶æˆ–ç›¸æœºè¯»å–å›¾åƒ
- âœ… å‘å¸ƒåˆ° ROS è¯é¢˜

**è¾“å‡º**:
- `/camera/image_raw` (sensor_msgs/Image)

**å…³é”®æ–‡ä»¶**:
- [`scripts/pub_video_node.py`](../ros_orbslam_ws/src/pub_video/scripts/pub_video_node.py)

---

## ğŸ—‚ï¸ å®Œæ•´ç›®å½•ç»“æ„

```
orbslam_depthmaping_ros_2/
â”‚
â”œâ”€â”€ ğŸ“„ build.sh                          # è‡ªåŠ¨æ„å»ºè„šæœ¬
â”œâ”€â”€ ğŸ“„ CMakeLists.txt                    # ORB-SLAM3 ä¸» CMake
â”œâ”€â”€ ğŸ“„ README.md                         # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ğŸ“„ .gitignore                        # Git å¿½ç•¥æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“ include/                          # ORB-SLAM3 å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ Atlas.h, System.h, Tracking.h...
â”‚   â””â”€â”€ CameraModels/
â”‚
â”œâ”€â”€ ğŸ“ src/                              # ORB-SLAM3 æºä»£ç 
â”‚   â”œâ”€â”€ System.cc, Tracking.cc...
â”‚   â””â”€â”€ (C++ å®ç°)
â”‚
â”œâ”€â”€ ğŸ“ lib/                              # ç¼–è¯‘åçš„åº“
â”‚   â””â”€â”€ libORB_SLAM3.so
â”‚
â”œâ”€â”€ ğŸ“ Thirdparty/                       # ç¬¬ä¸‰æ–¹åº“
â”‚   â”œâ”€â”€ DBoW2/                          # è¯è¢‹åº“
â”‚   â”œâ”€â”€ g2o/                            # å›¾ä¼˜åŒ–åº“
â”‚   â””â”€â”€ Sophus/                         # æç¾¤åº“
â”‚
â”œâ”€â”€ ğŸ“ Vocabulary/                       # ORB è¯æ±‡è¡¨
â”‚   â””â”€â”€ ORBvoc.txt                      # (éœ€ä¸‹è½½, 139MB)
â”‚
â”œâ”€â”€ ğŸ“ MonoConfig/                       # ç›¸æœºé…ç½®
â”‚   â””â”€â”€ Fisheye.yaml                    # é±¼çœ¼ç›¸æœºå‚æ•°
â”‚
â”œâ”€â”€ ğŸ“ æŠ€æœ¯æ–¹æ¡ˆ/                         # æŠ€æœ¯æ–‡æ¡£ ğŸ“š
â”‚   â”œâ”€â”€ æ–¹æ¡ˆ2.md                        # ç³»ç»Ÿæ–¹æ¡ˆè®¾è®¡
â”‚   â”œâ”€â”€ åæ ‡ç³»é—®é¢˜åˆ†æ.md               # åæ ‡ç³»è½¬æ¢è¯´æ˜
â”‚   â”œâ”€â”€ GeoCalibé‡åŠ›å¯¹é½é›†æˆæ–¹æ¡ˆ.md     # GeoCalib é›†æˆæ–¹æ¡ˆ
â”‚   â”œâ”€â”€ GeoCalibé›†æˆ_æ–‡ä»¶æ¸…å•.md        # æ–‡ä»¶ä¿®æ”¹æ¸…å•
â”‚   â””â”€â”€ é¡¹ç›®æ¡†æ¶æ€»è§ˆ.md                 # æœ¬æ–‡æ¡£ â­
â”‚
â””â”€â”€ ğŸ“ ros_orbslam_ws/                   # ROS å·¥ä½œç©ºé—´ ğŸ¤–
    â”‚
    â”œâ”€â”€ ğŸ“ src/
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“ ORB_SLAM3_ROS/           # ORB-SLAM3 ROS åŒ…è£…
    â”‚   â”‚   â”œâ”€â”€ src/ros_mono.cc
    â”‚   â”‚   â”œâ”€â”€ CMakeLists.txt
    â”‚   â”‚   â””â”€â”€ package.xml
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“ depth_maping/            # æ·±åº¦æ˜ å°„åŒ… â­
    â”‚   â”‚   â”œâ”€â”€ scripts/
    â”‚   â”‚   â”‚   â”œâ”€â”€ depth_maping_node.py        # ä¸»èŠ‚ç‚¹
    â”‚   â”‚   â”‚   â”œâ”€â”€ gravity_estimate.py         # é‡åŠ›ä¼°è®¡ ğŸ†•
    â”‚   â”‚   â”‚   â”œâ”€â”€ setup_gravity_alignment.sh  # è‡ªåŠ¨åŒ–è„šæœ¬ ğŸ†•
    â”‚   â”‚   â”‚   â”œâ”€â”€ plan_path.py                # è·¯å¾„è§„åˆ’
    â”‚   â”‚   â”‚   â”œâ”€â”€ depth_anything_v2/          # æ·±åº¦æ¨¡å‹
    â”‚   â”‚   â”‚   â”œâ”€â”€ init_images/                # åˆå§‹åŒ–å›¾åƒ (è¿è¡Œæ—¶ç”Ÿæˆ)
    â”‚   â”‚   â”‚   â”œâ”€â”€ gravity_rotation.yaml       # æ—‹è½¬çŸ©é˜µ (è¿è¡Œæ—¶ç”Ÿæˆ)
    â”‚   â”‚   â”‚   â””â”€â”€ gravity_visualization.jpg   # å¯è§†åŒ– (è¿è¡Œæ—¶ç”Ÿæˆ)
    â”‚   â”‚   â”œâ”€â”€ msg/
    â”‚   â”‚   â”‚   â””â”€â”€ ImagePose.msg               # è‡ªå®šä¹‰æ¶ˆæ¯
    â”‚   â”‚   â”œâ”€â”€ QUICK_START_GRAVITY.md          # å¿«é€Ÿå¼€å§‹ ğŸ†•
    â”‚   â”‚   â”œâ”€â”€ README_GRAVITY_ALIGNMENT.md     # è¯¦ç»†æ–‡æ¡£ ğŸ†•
    â”‚   â”‚   â”œâ”€â”€ CMakeLists.txt
    â”‚   â”‚   â””â”€â”€ package.xml
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“ octomap_mapping/         # Octomap å»ºå›¾åŒ…
    â”‚   â”‚   â”œâ”€â”€ scripts/
    â”‚   â”‚   â”‚   â””â”€â”€ octomap_mapping_node.py
    â”‚   â”‚   â”œâ”€â”€ launch/
    â”‚   â”‚   â”‚   â””â”€â”€ octomap_mapping.launch
    â”‚   â”‚   â”œâ”€â”€ CMakeLists.txt
    â”‚   â”‚   â””â”€â”€ package.xml
    â”‚   â”‚
    â”‚   â””â”€â”€ ğŸ“ pub_video/               # è§†é¢‘å‘å¸ƒåŒ…
    â”‚       â”œâ”€â”€ scripts/
    â”‚       â”‚   â””â”€â”€ pub_video_node.py
    â”‚       â”œâ”€â”€ CMakeLists.txt
    â”‚       â””â”€â”€ package.xml
    â”‚
    â”œâ”€â”€ ğŸ“ build/                        # ç¼–è¯‘è¾“å‡º
    â”œâ”€â”€ ğŸ“ devel/                        # å¼€å‘ç¯å¢ƒ
    â”œâ”€â”€ ğŸ“„ run.sh                        # å¿«é€Ÿå¯åŠ¨è„šæœ¬
    â””â”€â”€ ğŸ“„ launch_full_system.sh         # å®Œæ•´ç³»ç»Ÿå¯åŠ¨ (äº¤äº’å¼)
```

---

## ğŸ”„ ROS è¯é¢˜å’Œæ•°æ®æµ

### è¯é¢˜åˆ—è¡¨

| è¯é¢˜åç§° | æ¶ˆæ¯ç±»å‹ | å‘å¸ƒè€… | è®¢é˜…è€… | é¢‘ç‡ | è¯´æ˜ |
|---------|---------|--------|--------|------|------|
| `/camera/image_raw` | sensor_msgs/Image | pub_video_node | ORB-SLAM3 | 30 Hz | åŸå§‹å›¾åƒ |
| `/orb_slam3/image_pose` | depth_maping/ImagePose | ORB-SLAM3 | depth_maping_node<br>octomap_mapping_node | 30 Hz | å›¾åƒ+ä½å§¿ |
| `/depth_anything/depth_image` | sensor_msgs/Image | depth_maping_node | octomap_mapping_node | 15-30 Hz | æ·±åº¦å›¾ |
| `/o3d_pointCloud` | sensor_msgs/PointCloud2 | depth_maping_node | RViz | 10 Hz | 3D ç‚¹äº‘ï¼ˆå·²å¯¹é½ï¼‰ |
| `/octomap_2d` | nav_msgs/OccupancyGrid | octomap_mapping_node | RViz, move_base | 1 Hz | 2D å æ®åœ°å›¾ |
| `/octomap_pointcloud` | sensor_msgs/PointCloud2 | octomap_mapping_node | RViz | 1 Hz | 3D å æ®ç‚¹äº‘ |

### è‡ªå®šä¹‰æ¶ˆæ¯

**ImagePose.msg**:
```
std_msgs/Header header
sensor_msgs/Image image
geometry_msgs/Pose pose
```

---

## âš™ï¸ å…³é”®å‚æ•°é…ç½®

### 1. ç›¸æœºå‚æ•°

**æ–‡ä»¶**: [`MonoConfig/Fisheye.yaml`](../MonoConfig/Fisheye.yaml)

```yaml
Camera.fx: 138.54264656
Camera.fy: 138.60053687
Camera.cx: 331.89824222
Camera.cy: 239.70296783

# é±¼çœ¼ç•¸å˜
Camera.k1: -0.05094921
Camera.k2: -0.00983458
Camera.k3: 0.00521841
Camera.k4: -0.00128268
```

### 2. æ·±åº¦ä¼°è®¡å‚æ•°

**æ–‡ä»¶**: [`depth_maping_node.py`](../ros_orbslam_ws/src/depth_maping/scripts/depth_maping_node.py)

```python
# æ¨¡å‹é…ç½®
encoder = 'vitb'           # æ¨¡å‹å¤§å°: vits/vitb/vitl/vitg
max_depth = 70.0           # æœ€å¤§æ·±åº¦ (ç±³)
input_size = 518           # è¾“å…¥å°ºå¯¸

# æ»‘åŠ¨çª—å£
enable_sliding_window = True
sliding_window_size = 3    # ä¿ç•™æœ€è¿‘ N å¸§

# å¯è§†åŒ–
enable_visualization = False  # è¿œç¨‹ç¯å¢ƒç¦ç”¨
```

### 3. Octomap å‚æ•°

**æ–‡ä»¶**: [`octomap_mapping.launch`](../ros_orbslam_ws/src/octomap_mapping/launch/octomap_mapping.launch)

```xml
<param name="resolution" value="0.05"/>        <!-- 5cm åˆ†è¾¨ç‡ -->
<param name="max_range" value="10.0"/>         <!-- æœ€å¤§æ·±åº¦ -->
<param name="map_height_min" value="0.3"/>     <!-- åœ°å›¾é«˜åº¦ä¸‹é™ -->
<param name="map_height_max" value="2.0"/>     <!-- åœ°å›¾é«˜åº¦ä¸Šé™ -->
<param name="map_size_x" value="20.0"/>        <!-- åœ°å›¾ X èŒƒå›´ -->
<param name="map_size_y" value="20.0"/>        <!-- åœ°å›¾ Y èŒƒå›´ -->
```

---

## ğŸš€ å¯åŠ¨æ–¹å¼

### æ–¹æ³• 1: å®Œæ•´ç³»ç»Ÿå¯åŠ¨ï¼ˆæ¨èï¼‰â­

```bash
cd ros_orbslam_ws
./launch_full_system.sh
```

äº¤äº’å¼èœå•ï¼Œé€‰æ‹©å¯åŠ¨æ¨¡å¼ã€‚

### æ–¹æ³• 2: ä½¿ç”¨ Launch æ–‡ä»¶

```bash
roslaunch octomap_mapping octomap_mapping.launch
```

### æ–¹æ³• 3: æ‰‹åŠ¨å¯åŠ¨å„èŠ‚ç‚¹

```bash
# ç»ˆç«¯ 1: ROS Master
roscore

# ç»ˆç«¯ 2: è§†é¢‘å‘å¸ƒ
rosrun pub_video pub_video_node.py

# ç»ˆç«¯ 3: ORB-SLAM3
rosrun orb_slam3_ros orb_mono \
    ../Vocabulary/ORBvoc.txt \
    ../MonoConfig/Fisheye.yaml

# ç»ˆç«¯ 4: æ·±åº¦æ˜ å°„
rosrun depth_maping depth_maping_node.py \
    _enable_visualization:=false

# ç»ˆç«¯ 5: Octomap å»ºå›¾
roslaunch octomap_mapping octomap_mapping.launch

# ç»ˆç«¯ 6: RViz å¯è§†åŒ–
rviz
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°åŠŸèƒ½

1. **å®æ—¶ SLAM**
   - ORB-SLAM3 å•ç›®ä½å§¿ä¼°è®¡
   - å›ç¯æ£€æµ‹å’Œåœ°å›¾ä¼˜åŒ–
   - æ”¯æŒé±¼çœ¼ç›¸æœº

2. **æ·±åº¦ä¼°è®¡**
   - Depth Anything V2 æ·±åº¦å­¦ä¹ æ¨¡å‹
   - å•ç›®å›¾åƒ â†’ ç¨ å¯†æ·±åº¦å›¾
   - æ”¯æŒ TensorRT åŠ é€Ÿ

3. **3D å»ºå›¾**
   - åŸºäºä½“ç´ ç½‘æ ¼çš„å æ®åœ°å›¾
   - å°„çº¿è¿½è¸ªæ ‡è®°è‡ªç”±ç©ºé—´
   - å®æ—¶æ›´æ–°å’Œå¯è§†åŒ–

4. **2D å»ºå›¾**
   - 3D åœ°å›¾æŠ•å½±åˆ° 2D
   - å…¼å®¹ ROS Navigation Stack
   - å¯ç”¨äº move_base å¯¼èˆª

5. **é‡åŠ›å¯¹é½** ğŸ†•
   - GeoCalib ä¼°è®¡é‡åŠ›æ–¹å‘
   - è‡ªåŠ¨å¯¹é½ç‚¹äº‘åˆ°æ°´å¹³é¢
   - æ–‡ä»¶ç³»ç»Ÿè§£è€¦ Python ç‰ˆæœ¬
   - ä¸€é”®è‡ªåŠ¨åŒ–è®¾ç½®

### ğŸ”„ å·¥ä½œæµç¨‹

```
1. ç›¸æœºé‡‡é›†å›¾åƒ
   â†“
2. ORB-SLAM3 ä¼°è®¡ä½å§¿
   â†“
3. Depth Anything V2 ä¼°è®¡æ·±åº¦
   â†“
4. ç”Ÿæˆ 3D ç‚¹äº‘ï¼ˆå¸¦é‡åŠ›å¯¹é½ï¼‰
   â†“
5. Octomap æ„å»º 3D å æ®åœ°å›¾
   â†“
6. æŠ•å½±ç”Ÿæˆ 2D å æ®åœ°å›¾
   â†“
7. RViz å¯è§†åŒ–
```

---

## ğŸ”§ åæ ‡ç³»è¯´æ˜

### ç›¸æœºåæ ‡ç³»ï¼ˆOpenCVï¼‰
```
    Z (å‰)
   /
  /
 +-------> X (å³)
 |
 |
 v Y (ä¸‹)
```

### ROS åæ ‡ç³»ï¼ˆREP 103ï¼‰
```
    Z (ä¸Š)
   /
  /
 +-------> X (å‰)
 |
 |
 v Y (å·¦)
```

### è½¬æ¢çŸ©é˜µ

```python
R_cam_to_ros = np.array([
    [0,  0,  1],   # ROS X = Cam Z
    [-1, 0,  0],   # ROS Y = -Cam X
    [0, -1,  0]    # ROS Z = -Cam Y
])
```

**è¯¦ç»†è¯´æ˜**: [`åæ ‡ç³»é—®é¢˜åˆ†æ.md`](./åæ ‡ç³»é—®é¢˜åˆ†æ.md)

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### Jetson Orin

| æ¨¡å— | å¸§ç‡ | å»¶è¿Ÿ | å¤‡æ³¨ |
|------|------|------|------|
| ORB-SLAM3 | 40-60 FPS | ~20ms | å•ç›®æ¨¡å¼ |
| Depth Anything V2 | 15-30 FPS | ~50ms | vitb æ¨¡å‹ |
| Octomap æ›´æ–° | 10 FPS | ~100ms | å–å†³äºç‚¹äº‘å¯†åº¦ |
| 2D åœ°å›¾å‘å¸ƒ | 1 Hz | - | å¯é…ç½® |

### x86 PC (RTX 3060)

| æ¨¡å— | å¸§ç‡ | å»¶è¿Ÿ | å¤‡æ³¨ |
|------|------|------|------|
| ORB-SLAM3 | 60+ FPS | ~15ms | å•ç›®æ¨¡å¼ |
| Depth Anything V2 | 30-60 FPS | ~20ms | vitb æ¨¡å‹ |
| Octomap æ›´æ–° | 20 FPS | ~50ms | å–å†³äºç‚¹äº‘å¯†åº¦ |

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. æ¨¡å—å¯¼å…¥é”™è¯¯
```
ModuleNotFoundError: No module named 'depth_anything_v2'
```
**è§£å†³**: å·²åœ¨ä»£ç ä¸­è‡ªåŠ¨æ·»åŠ è·¯å¾„

### 2. Open3D GLX é”™è¯¯
```
GLFW Error: GLX: Failed to make context current
```
**è§£å†³**: ä½¿ç”¨ `_enable_visualization:=false`

### 3. æ·±åº¦å›¾æœªæ¥æ”¶
```
ç­‰å¾…æ·±åº¦å›¾æ•°æ®...
```
**è§£å†³**: ç¡®ä¿ depth_maping_node æ­£åœ¨è¿è¡Œ

### 4. ç‚¹äº‘æ–¹å‘é”™è¯¯
**è§£å†³**: å·²æ·»åŠ åæ ‡ç³»è½¬æ¢ï¼Œè¯¦è§åæ ‡ç³»æ–‡æ¡£

### 5. GeoCalib å®‰è£…å¤±è´¥
**è§£å†³**: éœ€è¦ Python 3.9+ï¼Œè¯¦è§ [`QUICK_START_GRAVITY.md`](../ros_orbslam_ws/src/depth_maping/QUICK_START_GRAVITY.md)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£ç´¢å¼•

### ğŸ“– æ ¸å¿ƒæ–‡æ¡£
- [`README.md`](../README.md) - é¡¹ç›®è¯´æ˜å’Œå®‰è£…æŒ‡å—
- [`æ–¹æ¡ˆ2.md`](./æ–¹æ¡ˆ2.md) - ç³»ç»Ÿæ–¹æ¡ˆè®¾è®¡å’ŒæŠ€æœ¯é€‰å‹

### ğŸ”§ æŠ€æœ¯æ–‡æ¡£
- [`åæ ‡ç³»é—®é¢˜åˆ†æ.md`](./åæ ‡ç³»é—®é¢˜åˆ†æ.md) - åæ ‡ç³»è½¬æ¢è¯¦è§£
- [`GeoCalibé‡åŠ›å¯¹é½é›†æˆæ–¹æ¡ˆ.md`](./GeoCalibé‡åŠ›å¯¹é½é›†æˆæ–¹æ¡ˆ.md) - GeoCalib é›†æˆå®Œæ•´æ–¹æ¡ˆ
- [`GeoCalibé›†æˆ_æ–‡ä»¶æ¸…å•.md`](./GeoCalibé›†æˆ_æ–‡ä»¶æ¸…å•.md) - æ–‡ä»¶ä¿®æ”¹æ¸…å•

### ğŸ“ ä½¿ç”¨æ–‡æ¡£
- [`QUICK_START_GRAVITY.md`](../ros_orbslam_ws/src/depth_maping/QUICK_START_GRAVITY.md) - é‡åŠ›å¯¹é½å¿«é€Ÿå¼€å§‹
- [`README_GRAVITY_ALIGNMENT.md`](../ros_orbslam_ws/src/depth_maping/README_GRAVITY_ALIGNMENT.md) - é‡åŠ›å¯¹é½è¯¦ç»†è¯´æ˜

---

## ğŸ”® å¼€å‘è·¯çº¿å›¾

### âœ… å·²å®Œæˆï¼ˆWeek 1-3ï¼‰
- [x] ORB-SLAM3 é›†æˆ
- [x] Depth Anything V2 é›†æˆ
- [x] Octomap å»ºå›¾ï¼ˆæ›¿ä»£ Voxbloxï¼‰
- [x] åæ ‡ç³»è½¬æ¢
- [x] GeoCalib é‡åŠ›å¯¹é½
- [x] æ»‘åŠ¨çª—å£ç‚¹äº‘
- [x] å®Œæ•´æ–‡æ¡£ä½“ç³»

### ğŸš§ è¿›è¡Œä¸­ï¼ˆWeek 3-4ï¼‰
- [ ] ç³»ç»Ÿæµ‹è¯•å’Œè°ƒä¼˜
- [ ] 2D åœ°å›¾è´¨é‡ä¼˜åŒ–
- [ ] åœ°å›¾ä¿å­˜/åŠ è½½åŠŸèƒ½
- [ ] RViz é…ç½®å®Œå–„

### ğŸ“… è®¡åˆ’ä¸­ï¼ˆWeek 5-8ï¼‰
- [ ] TensorRT åŠ é€Ÿæ·±åº¦ä¼°è®¡
- [ ] é›†æˆ ROS Navigation Stack
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œå†…å­˜ç®¡ç†
- [ ] å¤šç›¸æœºèåˆæ”¯æŒ

### ğŸŒŸ æœªæ¥å±•æœ›ï¼ˆ3ä¸ªæœˆ+ï¼‰
- [ ] 3D è¯­ä¹‰å æ®ç½‘ç»œï¼ˆMonoScene/FastOccï¼‰
- [ ] åŠ¨æ€éšœç¢ç‰©æ£€æµ‹
- [ ] å®Œæ•´çš„è‡ªä¸»å¯¼èˆªç³»ç»Ÿ
- [ ] äº‘ç«¯éƒ¨ç½²å’Œè¿œç¨‹ç›‘æ§

---

## ğŸ‘¥ è´¡çŒ®è€…

- **jayson-yxj** - åŸå§‹é¡¹ç›®å¼€å‘
- **Kilo Code** - GeoCalib é›†æˆã€æ–‡æ¡£å®Œå–„ã€ç³»ç»Ÿä¼˜åŒ–

---

## ğŸ“§ è”ç³»æ–¹å¼

- ğŸ“§ Email: 3630115255@qq.com
- ğŸ› GitHub Issues: [é¡¹ç›® Issues](https://github.com/jayson-yxj/orbslam_depthmaping_ros/issues)

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [ORB-SLAM3](https://github.com/UZ-SLAMLab/ORB_SLAM3) - GPLv3
- [Depth-Anything-V2](https://github.com/DepthAnything/Depth-Anything-V2) - Apache 2.0
- [GeoCalib](https://github.com/cvg/GeoCalib) - Apache 2.0

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-01-12  
**ç»´æŠ¤è€…**: Kilo Code

---

â­ **å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼**
